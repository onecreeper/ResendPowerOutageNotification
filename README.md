# 服务器断电和网络监控系统使用RESEND
## 简介
服务器断电和网络监控系统，通过定时任务检测服务器是否断电、内网和外网连接状态，在状态变化时自动发送邮件通知。

## 功能特性
- ✅ 断电检测和恢复通知
- ✅ 内网连接状态监控
- ✅ 外网连接状态监控  
- ✅ DNS解析状态检测
- ✅ 网络状态变化实时通知
- ✅ 自愈式心跳文件管理
- ✅ 严格的稳定性保障

## 项目起源
发现resend的api可以发送邮件，而且免费，不用白不用，没有需求就创造需求。然后~~自己~~AI写了一个脚本。

## 使用方法
1. 克隆本仓库
2. cd 到仓库目录
3. 修改docker-compose.yml文件，根据自己需求设置环境变量
4. docker-compose up -d 或者 docker compose up -d

## 环境变量配置说明

### 必需配置
- `RESEND_API_KEY`: Resend.com的API密钥
- `SENDER_FROM_ADDRESS`: 发件人邮箱地址（必须是验证过的域名）
- `RECIPIENT_EMAIL`: 收件人邮箱地址

### 服务器配置
- `SERVER_NAME`: 服务器名称（用于邮件标识）
- `OUTAGE_THRESHOLD`: 断电判定阈值（秒，默认180）
- `NETWORK_OUTAGE_THRESHOLD`: 网络异常判定阈值（秒，默认300）
- `TZ`: 时区设置（建议Asia/Shanghai）

### 网络检测配置（可选）
- `INTERNAL_TARGETS`: 内网检测目标，逗号分隔（默认：192.168.1.1,192.168.0.1）
- `EXTERNAL_TARGETS`: 外网检测目标，逗号分隔（默认：114.114.114.114,223.5.5.5,baidu.com）
- `DNS_TARGET`: DNS检测目标（默认：baidu.com）

## 网络检测说明

系统会自动检测以下网络状态，所有检测目标均可通过环境变量自定义：

### 默认检测目标（中国大陆友好）
- **内网连接**: 常见路由器IP（192.168.1.1, 192.168.0.1）
- **外网连接**: 国内公共DNS（114.114.114.114, 223.5.5.5）和百度
- **DNS解析**: 百度域名（baidu.com）

### 自定义配置示例
```yaml
# 使用自定义检测目标
- INTERNAL_TARGETS=192.168.31.1,192.168.1.254
- EXTERNAL_TARGETS=8.8.8.8,1.1.1.1,google.com
- DNS_TARGET=google.com
```

当网络状态发生变化（中断或恢复）时，系统会立即发送通知邮件。
